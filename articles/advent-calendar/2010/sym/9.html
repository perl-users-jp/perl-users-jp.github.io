<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="takesako">
        <title>サルでもわかるPython顔文字プログラミング - Articles Advent Calendar 2010 Sym</title>
        <link rel="icon" href="/img/favicon.ico">
        <link href="TODO" rel="stylesheet">
    </head>
    <body>
        <h1>サルでもわかるPython顔文字プログラミング</h1>
        tag
            <a href='/tag/sym'>sym</a>
            <a href='/tag/python'>python</a>

        <p>こんにちは。<a href="http://twitter.com/takesako">id:TAKESAKO</a>です。</p><p>サルでもわかるシリーズ第一弾として、Python顔文字プログラミングの基礎を解説してみましょう。</p>

<div class="section">
    <h3>1. Python顔文字プログラミング</h3>
    <p>以下のプログラムをPythonインタプリタ上で動かすと、'saru' という文字列が表示されます。</p>

    <pre class="code prettyprint">`(&#39;&#39;&lt;&gt;&#39;&#39;)`[-~-~(&#39;&#39;==&#39;&#39;)]+`(&#39;&#39;&lt;&gt;&#39;&#39;)`[&#39;&#39;==&#39;&#39;]+`(&#39;&#39;==&#39;&#39;)`[&#39;&#39;==&#39;&#39;:-~-~(&#39;&#39;==&#39;&#39;)]</pre>

    <pre class="code prettyprint">&#39;saru&#39;</pre>
<p>実際に Python 2.7.1 のインタプリタで実行してみると確かにそうなります。</p>

    <pre class="code prettyprint">Python 2.7.1 (r271:86832, Nov 27 2010, 17:19:03) [MSC v.1500 32 bit] on win32
Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`[-~-~(&#39;&#39;==&#39;&#39;)]+`(&#39;&#39;&lt;&gt;&#39;&#39;)`[&#39;&#39;==&#39;&#39;]+`(&#39;&#39;==&#39;&#39;)`[&#39;&#39;==&#39;&#39;:-~-~(&#39;&#39;==&#39;&#39;)]
&#39;saru&#39;</pre>
<p>どうして 'saru' という文字列が生成されたのでしょうか。</p>

</div>
<div class="section">
    <h3>2. 真偽値の作成</h3>
    <p>まず、Pythonで文字列の比較を行うと、真偽値 True、False が返ります。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; (&#39;&#39;==&#39;&#39;)
True
&gt;&gt;&gt; (&#39;&#39;&lt;&gt;&#39;&#39;)
False</pre>
<p>記号だけで真偽値を簡単に作成することができました。</p>

</div>
<div class="section">
    <h3>3. 真偽値から数値を作る</h3>
    <p>次に真偽値から数値に変換することを考えてみます。真偽値に対して数値演算を施すとint(True)は1に、int(False)は0として評価されます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; int(True)
1
&gt;&gt;&gt; True+0
1
&gt;&gt;&gt; True-0
1
&gt;&gt;&gt; True/1
1
&gt;&gt;&gt; True+0
1
&gt;&gt;&gt; True-0
1
&gt;&gt;&gt; True*1
1
&gt;&gt;&gt; True/1
1
&gt;&gt;&gt; int(False)
0
&gt;&gt;&gt; False+0
0
&gt;&gt;&gt; False-0
0
&gt;&gt;&gt; False*1
0
&gt;&gt;&gt; False/1
0</pre>
<p>記号だけで数値を生成したいので、単項演算子の+や-、ビット反転の~を使ってみます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; +True
1
&gt;&gt;&gt; -True
-1
&gt;&gt;&gt; ~True
-2
&gt;&gt;&gt; +False
0
&gt;&gt;&gt; -False
0
&gt;&gt;&gt; ~False
-1</pre>
<p>現在のコンピュータでは、<a href="http://ja.wikipedia.org/wiki/%E7%AC%A6%E5%8F%B7%E4%BB%98%E6%95%B0%E5%80%A4%E8%A1%A8%E7%8F%BE#2.E3.81.AE.E8.A3.9C.E6.95.B0">2の補数</a>で負の数を表しているので、たとえば8bitでのビット表現は以下の数値と対応します。</p>

<table>
    <tr>
    <th>ビット表現</th>
    <th>2の補数表現</th>
    <th>符号無し表現</th>
    </tr>
    <tr>
    <td>00000000</td>
    <td>  0</td>
    <td>  0</td>
    </tr>
    <tr>
    <td>00000001</td>
    <td>  1</td>
    <td>  1</td>
    </tr>
    <tr>
    <td>01111110</td>
    <td>126</td>
    <td>126</td>
    </tr>
    <tr>
    <td>01111111</td>
    <td>127</td>
    <td>127</td>
    </tr>
    <tr>
    <td>11111110</td>
    <td> -2</td>
    <td>254</td>
    </tr>
    <tr>
    <td>11111111</td>
    <td> -1</td>
    <td>255</td>
    </tr>
</table><p>ビット反転~演算子は0を→1に、1を→0に変換するので、~0==-1、~1==-2、となります。</p>

</div>
<div class="section">
    <h3>4. 記号だけで任意の整数を生成する</h3>
    <p>これらを応用すると、記号だけで任意の整数を生成することができます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; ~(&#39;&#39;==&#39;&#39;)
-2
&gt;&gt;&gt; -(&#39;&#39;==&#39;&#39;)
-1
&gt;&gt;&gt; +(&#39;&#39;&lt;&gt;&#39;&#39;)
0
&gt;&gt;&gt; +(&#39;&#39;==&#39;&#39;)
1
&gt;&gt;&gt; -~(&#39;&#39;==&#39;&#39;)
2
&gt;&gt;&gt; -~-~(&#39;&#39;==&#39;&#39;)
3
&gt;&gt;&gt; -~-~-~(&#39;&#39;==&#39;&#39;)
4</pre>

<ul>
<li>~-~-~を何回も繰り返していけば、どんな整数でも生成できそうですね！</li>
</ul><p>以上、ここまで大丈夫でしょうか。</p>

</div>
<div class="section">
    <h3>5. 真偽値から文字列を作成</h3>
    <p>Pythonではバッククォートで囲うとrepr関数を呼び出したときと同等の動作となり、その評価結果をインタプリタ表現のリテラル文字列として受け取れるという仕様があります。（Python3.0ではバッククォートの表記は廃止されました）</p>

    <pre class="code prettyprint">&gt;&gt;&gt; (&#39;&#39;==&#39;&#39;)
True
&gt;&gt;&gt; `(&#39;&#39;==&#39;&#39;)`
&#39;True&#39;
&gt;&gt;&gt; repr(&#39;&#39;==&#39;&#39;)
&#39;True&#39;
&gt;&gt;&gt; (&#39;&#39;&lt;&gt;&#39;&#39;)
False
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`
&#39;False&#39;
&gt;&gt;&gt; repr(&#39;&#39;&lt;&gt;&#39;&#39;)`
&#39;False&#39;</pre>
<p>これを利用すると'True'や'False'を文字列として扱うことができるので、文字列の演算を適用できます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; `(&#39;&#39;==&#39;&#39;)`+`(&#39;&#39;&lt;&gt;&#39;&#39;)`
&#39;TrueFalse&#39;
&gt;&gt;&gt; `(&#39;&#39;==&#39;&#39;)`*3
&#39;TrueTrueTrue&#39;</pre>

</div>
<div class="section">
    <h3>6. 部分文字列を切りだす</h3>
    <p>Pythonの文字列は、配列の要素の形式でアクセスすることにより部分文字列を取り出すことができます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; `True`[0]
&#39;T&#39;
&gt;&gt;&gt; `True`[1]
&#39;r&#39;
&gt;&gt;&gt; `True`[2]
&#39;u&#39;
&gt;&gt;&gt; `True`[3]
&#39;e&#39;
&gt;&gt;&gt; `False`[0]
&#39;F&#39;
&gt;&gt;&gt; `False`[1]
&#39;a&#39;
&gt;&gt;&gt; `False`[2]
&#39;l&#39;
&gt;&gt;&gt; `False`[3]
&#39;s&#39;
&gt;&gt;&gt; `False`[4]
&#39;e&#39;</pre>
<p>よくみると、`False`[3]で's'が生成され、`False`[1]で'a'が生成されていますね。これを足してみましょう。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; &#39;s&#39;+&#39;a&#39;
&#39;sa&#39;
&gt;&gt;&gt; `False`[3]+`False`[1]
&#39;sa&#39;</pre>
<p>前半の'sa'のできあがりです！</p>

</div>
<div class="section">
    <h3>7. 範囲指定で部分文字列を切りだす</h3>
    <p>:の記号を使って範囲指定で複数バイトの部分文字を取り出すこともできます。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; `True`[0:4]
&#39;True&#39;
&gt;&gt;&gt; `True`[1:4]
&#39;rue&#39;
&gt;&gt;&gt; `True`[2:4]
&#39;ue&#39;
&gt;&gt;&gt; `True`[3:4]
&#39;e&#39;
&gt;&gt;&gt; `True`[0:2]
&#39;Tr&#39;</pre>
<p>ということは、'True'の1文字目から2文字目までの文字列を切り出すと、</p>

    <pre class="code prettyprint">&gt;&gt;&gt; `True`[1:3]
&#39;ru&#39;</pre>
<p>となり、後半の'ru'が作成できました！</p>

</div>
<div class="section">
    <h3>7. 記号だけで 'saru' を生成する</h3>
    <p>まとまると、前半の'sa'はFalseの文字列から作成し、</p>

    <pre class="code prettyprint">&gt;&gt;&gt; (&#39;&#39;&lt;&gt;&#39;&#39;)
False
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`
&#39;False&#39;
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`[3]+
&#39;s&#39;
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`[1]
&#39;a&#39;</pre>
<p>後半の'ru'をTrueの文字列から作成すれば、'saru'の完成です！</p>

    <pre class="code prettyprint">&gt;&gt;&gt; (&#39;&#39;==&#39;&#39;)
True
&gt;&gt;&gt; `(&#39;&#39;==&#39;&#39;)`
&#39;True&#39;
&gt;&gt;&gt; `(&#39;&#39;==&#39;&#39;)`[1:3]
&#39;ru&#39;</pre>
<p>あとは数字を全部記号に書き直せば完成です。</p>

    <pre class="code prettyprint">&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`[3]+`(&#39;&#39;&lt;&gt;&#39;&#39;)`[1]+`(&#39;&#39;==&#39;&#39;)`[1:3]
&#39;saru&#39;
&gt;&gt;&gt; -~-~(&#39;&#39;==&#39;&#39;)
3
&gt;&gt;&gt; +(&#39;&#39;==&#39;&#39;)
1
&gt;&gt;&gt; `(&#39;&#39;&lt;&gt;&#39;&#39;)`[-~-~(&#39;&#39;==&#39;&#39;)]+`(&#39;&#39;&lt;&gt;&#39;&#39;)`[&#39;&#39;==&#39;&#39;]+`(&#39;&#39;==&#39;&#39;)`[&#39;&#39;==&#39;&#39;:-~-~(&#39;&#39;==&#39;&#39;)]
&#39;saru&#39;</pre>
<p>ね、簡単でしょ？</p>

</div>
<div class="section">
    <h3>8. まとめ</h3>
    <p>Pythonのインタプリタでは記号だけで'saru'という文字を生成できました。<br />
しかし、この方法では記号だけで生成できる記号以外の文字は T r u e F a l s e 0 1 2 3 4 5 6 7 8 9 L だけになってしまいます。<br />
任意の文字列を生成するには記号の他にcの文字を使わないといけなかったり、任意の文の実行にはexecを使用したりしないと実現できないかもしれません。</p><p>これ以上の発展は読者の方への宿題としたいと思います。</p><p>以上、サルでもわかる顔文字系プログラミングの解説でした。</p>

</div>
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?lang=css&amp;skin=sunburst"></script>
    </body>
</html>
